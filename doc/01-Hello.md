# C++やろうぜ
C++はC言語の上位互換の言語だし、C++の機能も使ったほうが多分いいよね。

ってことでまずはC言語のよくあるコードをC++のコードに書き換えてみるよ。

## Hello, world! in C++
C言語とC++で細かい違いがあるけど大体同じ。

```cpp
// hello.cpp
#include <iostream>
using namespace std;

int main() {
    cout << "Hello, world!\n";
    return 0;
}
```

このコードをコンパイルして実行すると、

> Hello, world!

と出力される。

### 解説
`iostream`はC言語でいう`stdio.h`ファイル。これをincludeしないと標準入力と標準出力を扱えない。ここで注意しておきたいのが、C++の標準ライブラリの多くは`.h`が末尾に **付かない** ということ(`iostream.h`のようにしてはいけない)。付けたらコンパイラに怒られます。

`using namespace std;`はアレだ、おまじない。これを書いておくと後々少し楽になる程度のもの。ちなみに`std`はstandardの略。標準ライブラリ絡みの記述であることは覚えておいてもいいかもしれない。

`main()`関数内1行目で、Hello, world!と出力するようにしている。詳しくは次節。

## `printf()`的なことをする
C++でも`cstdio`をincludeすれば`printf()`関数を使えるけど、それよりも便利な方法があるからそれ使おう。

### 構文

```cpp
cout << 文字列や数値 << 文字列や数値 << ... ;
```

### 例

```cpp
cout << 24;
cout << "歳、";
cout << "学生" << "です。" << '\n';
```

### 実行結果
> 24歳、学生です。

### 解説
`iostream`にはグローバル変数として`cout`が定義されている。こいつに続けて`<<`の右に適当な値や変数を書くと、それを標準出力に出力してくれる。`cout`にグイグイと値を押し込む感じのイメージで。

`printf()`より優れている点は、わざわざ`"%d"`とか`"%s"`とか指定しなくても、自動で適切なフォーマットで出力してくれる。書き間違えしなくなってGood。

さらに複数の値を`<<`でつないで1文で出力することもできる(例の3行目)。`printf()`で`"%s%d:%f"`みたいなゴチャッとしたのを書かなくて済む。バグが減るよ！やったねたえちゃん！

「数値の桁数を指定して表示したい」とかは`cout`でもできなくはないけど、`printf()`使ったほうが楽だと思うからそっちも同時に使ってもいいよ(`cstdio`をincludeすること)。

```cpp
#include <iostream>
#include <cstdio>
using namespace std;

int main() {
    int yakuza = 893;

    cout << yakuza << '\n';
    printf("%05d\n", yakuza);

    return 0;
}
```
> 893  
> 00893

## `scanf()`的なことをする
`printf()`したら`scanf()`しよう。教科書的にはそれがテンプレ。

### 構文

```cpp
cin >> 変数名 >> 変数名 >> ... ;
```

### 例

```cpp
int num;
cout << "整数を入力してください> ";
cin >> num;
cout << num << "が入力されました。2倍すると" << num * 2 << "です。\n";
```

### 実行結果
> 整数を入力してください> *114514*  
> 114514が入力されました。2倍すると229028です。

### 解説
`iostream`にはグローバル変数として`cin`が定義されている。こいつに続けて`>>`の右に(`&`を付けずに)変数名を書くと、それを標準入力から入力してくれる。`cin`から値を引っ張ってくるイメージで(イメージは大切)。

`cout`と同じように、変数の型に応じて自動でやってくれる。Yeah

複数の変数を`>>`で区切って並べると左の変数から順番に入力される。心配なら複数行に分けて書けばOK。

「整数を入力してほしいのに文字列が入力されてキレそう」そんなときの対処もとても簡単。

```cpp
int num;
if (cin >> num) {
    cout << "正しく入力されました。\n";
} else {
    cout << "不正な値です。\n";
}
```

すごい。簡単。どんどん使おう。

## `char*`はやめて`string`を使おう
C++はC言語も扱えるから、文字列を扱うときに

```cpp
char* cstr = "焼いてかない？";
cout << cstr << '\n';
```

と書いても動く。でもC++で`string`をincludeすると使える型`string`はもっとイケてるからそれ使おう。てか使え

### 例

```cpp
#include <iostream>
#include <string> // string 型を使うために必要
using namespace std;

int main() {
    string str = "ああ＾～いいっすね＾～";
    cout << str << '\n';
    return 0;
}
```

### 実行結果

> ああ＾～いいっすね＾～

### なぜ`string`を使うのか
C言語では「文字列型」は無く、「文字の配列」として文字列を扱ってきた。「なんで文字列型は無いんだ」と疑問を持った人も多いはず。そこでC++では標準で文字列型が搭載された。

「新しく型が作られたんだから、いいことがいっぱいあるはず」はい。いっぱいあります。

#### 文字列の入力
例えば、標準入力から文字列を入力するとき、C言語だと入力できる文字数に限界があった。

```c
char cstr[20];
scanf("%s", cstr);
printf("%s\n", cstr);
```

この例だと、終端のnull文字を除いて19文字までしか入力を受け付けない。20文字以上入力するとバッファオーバーランして死ぬ。一般的な解決方法は確保する配列の配列長を長くすることだけど、あまりにも大きくし過ぎるとメモリの無駄になる。

そこで`string`の登場。上のコードを`string`を使って書くとこうなる。

```cpp
string str;
cin >> str;
cout << str << '\n';
```

ﾋﾞｭｰﾃｨﾌｫｰ・・・

`string`は文字列の長さに合わせて自動的にメモリを確保・開放するので、標準入力から何文字入力があっても大丈夫！やったぜ。

#### 文字へのアクセス
C言語と変わりません。以上

```cpp
string str = "abcdef"
char c = str[0];
cout << c << '\n';
str[3] = 'z';
cout << str << '\n';
```

> a  
> abczef

#### 文字列の操作
C言語で`string.h`に宣言してある文字列操作系の関数は、よく使うけど分かりづらい・・・

| 関数                       | 説明                         |
| -------------------------- | ---------------------------- |
| `char* strcpy(str1, str2)` | `str1`に`str2`をコピー       |
| `char* strcat(str1, str2)` | `str1`のうしろに`str2`を連結 |
| `int strcmp(str1, str2)`   | `str1`と`str2`を比較         |
| `size_t strlen(str)`       | `str`の長さを返す            |

`strlen()`はともかく、他の関数は引数の順序を逆にしそうで怖い。

そこで`string`での文字列操作を見てみましょう。

```cpp
string str1 = "8月16日（水）07時14分22秒"
string str2;

// strcpy 相当。文字列をコピーする
str2 = str1;

// strcat 相当。文字列を連結する
str2 += str1;

// strcmp 相当。文字列を比較する
if (str1 == str2) {
    cout << "str1 と str2 は同じ" << '\n';
}

// strlen 相当。文字列の長さを返す
int length = str.length();
```

ハラショー。

`str.length()`っていう表記は最初はちょっと慣れないかもしれない。感覚としては構造体のメンバ変数をいじるような感じ。「`str`の`length`」みたいな感じで覚えよう。この表記について詳しくは **クラス** の項目でやります。

#### `char*`との互換性
あります。どうしても必要なときに使いましょう。

```cpp
// string -> char*
string str = "hoge";
char* cstr = str.c_str();

// char* -> string
char* cstr = "fuga";
string str = cstr;
```

## やっぱり`using namespace std;`が気になる
今まで何気なく書いてきた`cout`、`cin`、`string`は実は正式名称ではありません。`using namespace std;`のお陰で省略して書くことができます。`using`文無しでは以下のように書きます。

```cpp
#include <iostream>
#include <string>

int main() {
    std::string str;
    std::cin >> str;
    std::cout << str << '\n';
    return 0;
}
```

`using namespace std;`がありません。代わりに`std::`が先頭についています。

`std`はC++の機能である **名前空間** の名前です。名前空間はグローバルな変数や関数をフォルダ分けしておける機能です。`cout`、`cin`、`string`は全部`std`名前空間に属しています。これによって名前の衝突を防ぐことができます。

でも、毎回名前空間名を書くのは面倒臭い・・・そんな時は`using namespace 名前空間名;`と書くことによって、省略をすることができます。

<前に戻る - [目次へ](../README.md) - [次へ進む](02-Function.md)>
